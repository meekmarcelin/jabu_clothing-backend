"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4546],{17379:function(W,v,r){r.d(v,{r:function(){return C}});var f=r(32735),T=r(72850),A=r(60216),I=r.n(A),S=r(74506);function k(M,O,p){if(!M||!O)return{display:"none"};const{x:b,y:x}=p;return{transform:`translate(${b}px, ${x}px)`}}function C({renderItem:M}){const{itemType:O,isDragging:p,item:b,initialOffset:x,currentOffset:K,mouseOffset:Z}=(0,S.useDragLayer)(L=>({item:L.getItem(),itemType:L.getItemType(),initialOffset:L.getInitialSourceClientOffset(),currentOffset:L.getSourceClientOffset(),isDragging:L.isDragging(),mouseOffset:L.getClientOffset()}));return p?f.createElement(T.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},f.createElement(T.x,{style:k(x,K,Z)},M({type:O,item:b}))):null}C.propTypes={renderItem:I().func.isRequired}},75430:function(W,v,r){var f=r(32735);const T=(0,f.createContext)();var A=null},69242:function(W,v,r){r.d(v,{PL:function(){return S},Y9:function(){return k.Y},zE:function(){return oe},Ky:function(){return ce},fi:function(){return B},zH:function(){return h},r5:function(){return l}});var f=r(32735),T=r(15062),A=r(53634),S=()=>{const n=(0,T.v9)(A.Z),e=(0,f.useCallback)(t=>n?.components?.[t]??{},[n]);return{...n,getComponentLayout:e}},k=r(77622),C=r(19565),M=r(84306),O=r(20716),p=r(97889);const b={error:null,isLoading:!0,layout:{},layouts:{}};var K=(n,e)=>(0,p.ZP)(n,t=>{switch(e.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=e.data.contentType.uid;t.layout=e.data,t.layouts[i]=e.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=e.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=n.layouts[e.uid];break}case"UPDATE_LAYOUT":{const i=n.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...e.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...e.newLayout.contentType}};break}default:return t}}),Z=r(99381),L=r.n(Z),H=r(33795),R=r.n(H),J=r(3040),N=r.n(J),se=r(97724);const X=(n,e)=>e.find(t=>t.uid===n),q=(n,e)=>{const t=w(n,e),i=P(t.contentType,e),c=_(t.contentType,t.components);return N()(t,["contentType","layouts","edit"],i),N()(t,["contentType","layouts","list"],c),Object.keys(t.components).forEach(a=>{const m=P(t.components[a],e);N()(t,["components",a,"layouts","edit"],m)}),t},w=(n,e)=>{const t=(0,se.w8)(L()(n),e,"contentType"),{components:i,contentType:c}=t,a=m=>Object.keys(m.metadatas).reduce((g,E)=>{const D=R()(m,["attributes",E],{});let F=m.metadatas[E];if(D.type==="relation"){const me=X(D.targetModel,e),j=F.edit.mainField,Q={name:j,schema:R()(me,["attributes",j])};F={list:{...F.list,mainField:Q},edit:{...F.edit,mainField:Q}}}return g[E]=F,g},{});return N()(t,["contentType","metadatas"],a(c)),Object.keys(i).forEach(m=>{const g=i[m],E=a(g);N()(t,["components",m,"metadatas"],E)}),t},P=(n,e)=>n.layouts.edit.reduce((t,i)=>{const c=i.map(a=>{const m=R()(n,["attributes",a.name],{}),g={...a,fieldSchema:m,metadatas:R()(n,["metadatas",a.name,"edit"],{})};if(m.type==="relation"){const D=X(m.targetModel,e).pluginOptions||{};N()(g,"targetModelPluginOptions",D),N()(g,"queryInfos",{shouldDisplayRelationLink:Y(n,a.name,e)})}return g});return t.push(c),t},[]),_=(n,e)=>n.layouts.list.reduce((i,c)=>{const a=R()(n,["attributes",c],{}),m=R()(n,["metadatas",c,"list"],{}),g=a.type;if(g==="relation")return i.push({key:`__${c}_key__`,name:c,fieldSchema:a,metadatas:m}),i;if(g==="component"){const E=e[a.component],D=E.settings.mainField,F=E.attributes[D];return i.push({key:`__${c}_key__`,name:c,fieldSchema:a,metadatas:{...m,mainField:{...F,name:D}}}),i}return i.push({key:`__${c}_key__`,name:c,fieldSchema:a,metadatas:m}),i},[]),Y=(n,e,t)=>{const i=R()(n,["attributes",e,"targetModel"],"");return U(t).includes(i)},U=n=>n.filter(e=>e.isDisplayed).map(({uid:e})=>e);var $=q,oe=n=>{const[{error:e,isLoading:t,layout:i,layouts:c},a]=(0,f.useReducer)(K,b),m=(0,f.useMemo)(O.Vo,[]),{schemas:g}=(0,T.v9)(j=>m(j),T.wU),E=(0,f.useRef)(!0),{get:D}=(0,C.kY)(),F=(0,f.useCallback)(async(j,Q)=>{if(c[j]){a({type:"SET_LAYOUT_FROM_STATE",uid:j});return}a({type:"GET_DATA"});try{const{data:{data:re}}=await D(`/content-manager/content-types/${j}/configuration`,{cancelToken:Q.token});a({type:"GET_DATA_SUCCEEDED",data:$(re,g)})}catch(re){if(M.default.isCancel(re))return;E.current&&console.error(re),E.current&&a({type:"GET_DATA_ERROR",error:re})}},[c,g,D]);(0,f.useEffect)(()=>()=>{E.current=!1},[]),(0,f.useEffect)(()=>{const Q=M.default.CancelToken.source();return F(n,Q),()=>{Q.cancel("Operation canceled by the user.")}},[n,F]);const me=(0,f.useCallback)(j=>{a({type:"UPDATE_LAYOUT",newLayout:$(j,g)})},[g]);return{error:e,isLoading:t,layout:i,updateLayout:me}},ae=n=>n["content-manager_app"].collectionTypeLinks,ie=r(85973),ye=r.n(ie),z=r(33348);const y=(n,e)=>Object.keys(n).reduce((t,i)=>{const c=n[i],a=R()(e,[i],c);return ye()(c)?{...t,[i]:y(c,a)}:(t[i]=a,t)},{});var ue=(n,e,t)=>{const i=n.find(({to:F})=>F.includes(e));if(!i)return"/";const{to:c,search:a}=i,m=(0,z.parse)(a),g=(0,z.parse)(t.substring(1)),E=y(m,g);return`${c}?${(0,z.stringify)(E,{encode:!1})}`},ce=n=>{const[{rawQuery:e}]=(0,C.Kx)(),t=(0,T.v9)(ae);return ue(t,n,e)},pe=r(15655),V=r(53038),B=()=>{const{search:n}=(0,V.TH)(),e=n?(0,z.parse)(n.substring(1)):{};return e.plugins?(0,z.stringify)({plugins:e.plugins},{encode:!1}):""};const h=n=>{const e=(0,f.useRef)();return(0,f.useEffect)(()=>{e.current=n},[n]),e.current};var G=r(85149);const le=(n,e,t)=>({type:G.m,permissions:n,__meta__:{plugins:e,containerName:t}}),ne=()=>({type:G.Q}),de=n=>n["content-manager_rbacManager"].permissions,fe=n=>n.rbacProvider.collectionTypesRelatedPermissions;var l=(n,e,t="listView")=>{const i=(0,T.v9)(fe),c=(0,T.v9)(de),a=(0,T.I0)(),m=i[e];return(0,f.useEffect)(()=>m?(a(le(m,n?n.plugins:null,t)),()=>{a(ne())}):()=>{},[m,a,n,t]),c},u=r(75430);const o=()=>useContext(WysiwygContext);var d=null},77622:function(W,v,r){r.d(v,{Y:function(){return S}});var f=r(32735),T=r(74506),A=r.n(T),I=r(15655);const S=(k,{type:C="STRAPI_DND",index:M,item:O={},onStart:p,onEnd:b,onGrabItem:x,onDropItem:K,onCancel:Z,onMoveItem:L,dropSensitivity:H="regular"})=>{const R=(0,f.useRef)(null),[{handlerId:J},N]=(0,T.useDrop)({accept:C,collect(P){return{handlerId:P.getHandlerId()}},hover(P,_){if(!R.current)return;const Y=P.index,U=M;if(Y!==U){if(H==="regular"){const $=R.current.getBoundingClientRect(),ee=($.bottom-$.top)/2,te=_.getClientOffset().y-$.top;if(Y<U&&te<ee||Y>U&&te>ee)return}L(U,Y),P.index=U}}}),[{isDragging:se},X,q]=(0,T.useDrag)({type:C,item(){p&&p();const{width:P}=R.current?.getBoundingClientRect()??{};return{index:M,width:P,...O}},end(){b&&b()},canDrag:k,isDragging:O.id?P=>O.id===P.getItem().id:void 0,collect:P=>({isDragging:P.isDragging()})}),w=(0,I.A)(k,M,{onGrabItem:x,onDropItem:K,onCancel:Z,onMoveItem:L});return[{handlerId:J,isDragging:se,handleKeyDown:w},R,N,X,q]}},15655:function(W,v,r){r.d(v,{A:function(){return T}});var f=r(32735);const T=(A,I,{onCancel:S,onDropItem:k,onGrabItem:C,onMoveItem:M})=>{const[O,p]=(0,f.useState)(!1),b=L=>{O&&(L==="UP"?M(I-1,I):L==="DOWN"&&M(I+1,I))},x=()=>{O?(k&&k(I),p(!1)):(C&&C(I),p(!0))},K=()=>{O&&(p(!1),S&&S(I))};return L=>{if(A&&!(L.key==="Tab"&&!O))switch(L.preventDefault(),L.key){case" ":case"Enter":x();break;case"Escape":K();break;case"ArrowDown":case"ArrowRight":b("DOWN");break;case"ArrowUp":case"ArrowLeft":b("UP");break;default:}}}},20716:function(W,v,r){r.d(v,{Jg:function(){return M},KQ:function(){return k},Vo:function(){return C},Yg:function(){return A}});var f=r(98178),T=r(60371);const A=()=>p=>p["content-manager_app"]||T.E,I=()=>createSelector(A(),p=>p),S=()=>createSelector(A(),p=>p.models),k=()=>(0,f.P1)(A(),p=>({collectionTypeLinks:p.collectionTypeLinks,singleTypeLinks:p.singleTypeLinks})),C=()=>(0,f.P1)(A(),({components:p,models:b})=>({schemas:[...p,...b]})),M=(0,f.P1)(A(),p=>p.fieldSizes);var O=null},53634:function(W,v){const r=f=>f["content-manager_editViewLayoutManager"].currentLayout;v.Z=r},24381:function(W,v){v.Z={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},7921:function(W,v){const r=f=>`content-manager.${f}`;v.Z=r},97724:function(W,v,r){r.d(v,{_Q:function(){return te.Z},W3:function(){return I},ko:function(){return M},FE:function(){return p},Di:function(){return Z},Ex:function(){return fe},du:function(){return J},TA:function(){return X},Ts:function(){return _},Uo:function(){return U},IF:function(){return ee},OB:function(){return oe.Z},w8:function(){return z},kc:function(){return ue}});var f=r(99381),T=r.n(f),I=(s,l,u)=>{if(Array.isArray(s)&&l>=0&&u>=0&&l<=s.length-1&&u<=s.length-1){const o=T()(s),d=o.splice(l,1);return o.splice(u,0,d[0]),o}return s},S=r(59578),k=r.n(S),M=s=>{const l=s.type;return l==="relation"?!k()(s.relationType).includes("morph"):!["json","dynamiczone","richtext","password"].includes(l)&&!!l};const O=(s,l)=>{typeof s=="function"?s(l):s!=null&&(s.current=l)},p=(...s)=>l=>s.forEach(u=>O(u,l));var b=r(33795),x=r.n(b);const K=(s,l)=>Object.keys(s).reduce((u,o)=>{const d=x()(s,[o],{}),{default:n,component:e,type:t,required:i,min:c,repeatable:a}=d;if(n!==void 0&&(u[o]=n),t==="component"){const m=l?.[e]?.attributes??{},g=K(m,l);if(i===!0&&(u[o]=a===!0?[]:g),c&&a===!0&&i){u[o]=[];for(let E=0;E<c;E+=1)u[o].push(g)}}return t==="dynamiczone"&&i===!0&&(u[o]=[]),u},{});var Z=K,L=r(9086),H=r.n(L),J=({layouts:s,metadatas:l,...u})=>{const o=s.list.map(e=>e.name?e.name:e),d=Object.keys(l).reduce((e,t)=>{const i=x()(l,[t],{});let c=i.edit;return c.mainField&&(c={...c,mainField:i.edit.mainField.name}),{...e,[t]:{edit:c,list:H()(i.list,["mainField"])}}},{}),n=s.edit.map(e=>e.map(({name:t,size:i})=>({name:t,size:i})));return{...u,layouts:{edit:n,list:o},metadatas:d}};const N=(s,l)=>s.map(u=>({...u,subject:l}));var X=s=>{const l={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(l).reduce((u,o)=>(u[o]=N(l[o],s),u),{})},q=r(95919),w=r.n(q),_=s=>s.split(".").filter(l=>w()(parseInt(l,10))),U=s=>{if(s.length===0)return-1;const l=Math.max.apply(Math,s.map(u=>u.__temp_key__??0));return Number.isNaN(l)?-1:l},ee=s=>`/content-manager/${s}`,oe=r(7921),te=r(24381),ae=r(3040),ie=r.n(ae),z=(s,l,u)=>{const o=t=>l.find(i=>i.uid===t),d=Object.assign({},s),n=s[u].uid,e=o(n);return ie()(d,[u],{...s[u],...e}),Object.keys(s.components).forEach(t=>{const i=o(t);ie()(d,["components",t],{...s.components[t],...i})}),d},y=r(19565),ue=(s,l,u)=>{const o=(d,n)=>Object.keys(d).reduce((e,t)=>{const i=(0,y.UN)(n,t),c=x()(d,t),a=(0,y.k2)(n,[t,"component"]),m=(0,y.k2)(n,[t,"repeatable"]);return i==="dynamiczone"?(e[t]=c.map(g=>o(g,u[g.__component])),e):i==="component"?(m?e[t]=c&&c.map(g=>o(g,u[a])):e[t]=c&&o(c,u[a]),e):(i!=="password"&&(e[t]=c),e)},{});return o(s,l)},ge=r(51355),ce=r.n(ge),pe=r(86834),V=r.n(pe),he=r(78746),B=r.n(he),h=r(24346),G=r(73347);h.kM(h.nK,"defined",function(){return this.test("defined",y.I0.required,s=>s!==void 0)}),h.kM(h.IX,"notEmptyMin",function(s){return this.test("notEmptyMin",y.I0.min,l=>V()(l)?!0:l.length>=s)}),h.kM(h.Z_,"isInferior",function(s,l){return this.test("isInferior",s,function(u){return!u||Number.isNaN(B()(u))?!0:B()(l)>=B()(u)})}),h.kM(h.Z_,"isSuperior",function(s,l){return this.test("isSuperior",s,function(u){return!u||Number.isNaN(B()(u))?!0:B()(u)>=B()(l)})});const le=s=>x()(s,["attributes"],{}),ne=(s,{components:l},u={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=le(s);return h.Ry().shape(Object.keys(o).reduce((d,n)=>{const e=o[n];if(e.type!=="relation"&&e.type!=="component"&&e.type!=="dynamiczone"){const t=de(e.type,e,u);d[n]=t}if(e.type==="relation"&&(d[n]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(e.relationType)?h.Ry().nullable():h.IX().nullable()),e.type==="component"){const t=ne(l[e.component],{components:l},{...u,isFromComponent:!0});if(e.repeatable===!0){const{min:c,max:a,required:m}=e;let g=h.Vo(E=>{let D=h.IX().of(t);return c?m?D=D.min(c,y.I0.min):m!==!0&&V()(E)?D=D.nullable():D=D.min(c,y.I0.min):m&&!u.isDraft&&(D=D.min(1,y.I0.required)),a&&(D=D.max(a,y.I0.max)),D});return d[n]=g,d}const i=h.Vo(c=>c!==void 0?e.required===!0&&!u.isDraft?t.defined():t.nullable():e.required===!0?h.Ry().defined():h.Ry().nullable());return d[n]=i,d}if(e.type==="dynamiczone"){let t=h.IX().of(h.Vo(({__component:a})=>ne(l[a],{components:l},{...u,isFromComponent:!0})));const{max:i,min:c}=e;c?e.required?t=t.test("min",y.I0.min,a=>u.isCreatingEntry?a&&a.length>=c:a===void 0?!0:a!==null&&a.length>=c).test("required",y.I0.required,a=>u.isCreatingEntry?a!==null||a!==void 0:a===void 0?!0:a!==null):t=t.notEmptyMin(c):e.required&&!u.isDraft&&(t=t.test("required",y.I0.required,a=>u.isCreatingEntry?a!==null||a!==void 0:a===void 0?!0:a!==null)),i&&(t=t.max(i,y.I0.max)),d[n]=t}return d},{}))},de=(s,l,u)=>{let o=h.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(s)&&(o=h.Z_()),s==="json"&&(o=h.nK(y.I0.json).test("isJSON",y.I0.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",y.I0.required,d=>!(l.required&&(!d||!d.length)))),s==="email"&&(o=o.email(y.I0.email)),["number","integer","float","decimal"].includes(s)&&(o=h.Rx().transform(d=>w()(d)?void 0:d).typeError()),s==="biginteger"&&(o=h.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(s)&&(o=h.hT()),Object.keys(l).forEach(d=>{const n=l[d];if(n||!ce()(n)&&Number.isInteger(Math.floor(n))||n===0)switch(d){case"required":{u.isDraft||(s==="password"&&u.isCreatingEntry&&(o=o.required(y.I0.required)),s!=="password"&&(u.isCreatingEntry?o=o.required(y.I0.required):o=o.test("required",y.I0.required,e=>e===void 0&&!u.isFromComponent?!0:(0,G.Z)(s)?e===0?!0:!!e:s==="boolean"?e!=null:s==="date"||s==="datetime"?typeof e=="string"?!V()(e):!V()(e?.toString()):!V()(e))));break}case"max":{s==="biginteger"?o=o.isInferior(y.I0.max,n):o=o.max(n,y.I0.max);break}case"maxLength":o=o.max(n,y.I0.maxLength);break;case"min":{s==="biginteger"?o=o.isSuperior(y.I0.min,n):o=o.min(n,y.I0.min);break}case"minLength":{u.isDraft||(o=o.min(n,y.I0.minLength));break}case"regex":o=o.matches(new RegExp(n),{message:y.I0.regex,excludeEmptyString:!l.required});break;case"lowercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().uppercase());break;case"positive":(0,G.Z)(s)&&(o=o.positive());break;case"negative":(0,G.Z)(s)&&(o=o.negative());break;default:o=o.nullable()}}),o};var fe=ne},73347:function(W,v,r){r.d(v,{Z:function(){return f}});function f(T){return["integer","biginteger","decimal","float","number"].includes(T)}}}]);
